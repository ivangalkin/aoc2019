#include <iostream>
#include <vector>
#include <set>
#include <map>
#include <tuple>
#include <assert.h>
#include <algorithm>


static std::vector<std::tuple<char, int>> first_ = {{'R', 8},
                                                    {'U', 5},
                                                    {'L', 5},
                                                    {'D', 3}};
static std::vector<std::tuple<char, int>> second_ = {{'U', 7},
                                                     {'R', 6},
                                                     {'D', 4},
                                                     {'L', 4}};

static std::vector<std::tuple<char, int>> first = {{'R', 1004},
                                                   {'U', 520},
                                                   {'R', 137},
                                                   {'D', 262},
                                                   {'L', 403},
                                                   {'U', 857},
                                                   {'R', 50},
                                                   {'U', 679},
                                                   {'R', 788},
                                                   {'D', 98},
                                                   {'L', 717},
                                                   {'D', 1},
                                                   {'R', 367},
                                                   {'U', 608},
                                                   {'L', 125},
                                                   {'U', 703},
                                                   {'L', 562},
                                                   {'D', 701},
                                                   {'L', 718},
                                                   {'U', 357},
                                                   {'R', 742},
                                                   {'D', 860},
                                                   {'R', 557},
                                                   {'D', 117},
                                                   {'R', 950},
                                                   {'U', 546},
                                                   {'L', 506},
                                                   {'U', 836},
                                                   {'R', 951},
                                                   {'D', 460},
                                                   {'L', 38},
                                                   {'U', 893},
                                                   {'L', 1},
                                                   {'D', 217},
                                                   {'R', 262},
                                                   {'D', 950},
                                                   {'R', 239},
                                                   {'U', 384},
                                                   {'R', 971},
                                                   {'D', 289},
                                                   {'R', 323},
                                                   {'U', 878},
                                                   {'L', 525},
                                                   {'U', 687},
                                                   {'L', 831},
                                                   {'U', 523},
                                                   {'R', 94},
                                                   {'D', 33},
                                                   {'L', 879},
                                                   {'D', 318},
                                                   {'R', 633},
                                                   {'D', 775},
                                                   {'R', 879},
                                                   {'D', 351},
                                                   {'L', 120},
                                                   {'D', 8},
                                                   {'R', 31},
                                                   {'U', 49},
                                                   {'R', 328},
                                                   {'D', 598},
                                                   {'L', 380},
                                                   {'D', 160},
                                                   {'R', 261},
                                                   {'D', 716},
                                                   {'R', 459},
                                                   {'U', 533},
                                                   {'L', 444},
                                                   {'U', 412},
                                                   {'L', 326},
                                                   {'U', 93},
                                                   {'L', 193},
                                                   {'D', 621},
                                                   {'R', 236},
                                                   {'U', 769},
                                                   {'L', 319},
                                                   {'D', 885},
                                                   {'L', 559},
                                                   {'U', 509},
                                                   {'L', 62},
                                                   {'U', 321},
                                                   {'L', 667},
                                                   {'D', 505},
                                                   {'R', 556},
                                                   {'U', 159},
                                                   {'L', 5},
                                                   {'U', 126},
                                                   {'L', 262},
                                                   {'D', 946},
                                                   {'L', 168},
                                                   {'U', 491},
                                                   {'L', 56},
                                                   {'D', 831},
                                                   {'R', 926},
                                                   {'U', 926},
                                                   {'R', 562},
                                                   {'D', 270},
                                                   {'R', 785},
                                                   {'U', 436},
                                                   {'R', 852},
                                                   {'D', 629},
                                                   {'R', 872},
                                                   {'U', 716},
                                                   {'R', 549},
                                                   {'U', 435},
                                                   {'R', 462},
                                                   {'U', 191},
                                                   {'R', 318},
                                                   {'U', 91},
                                                   {'L', 637},
                                                   {'D', 682},
                                                   {'R', 647},
                                                   {'D', 53},
                                                   {'L', 789},
                                                   {'D', 725},
                                                   {'R', 312},
                                                   {'D', 366},
                                                   {'L', 287},
                                                   {'U', 29},
                                                   {'R', 85},
                                                   {'D', 657},
                                                   {'R', 88},
                                                   {'U', 300},
                                                   {'R', 795},
                                                   {'U', 378},
                                                   {'R', 800},
                                                   {'D', 391},
                                                   {'L', 594},
                                                   {'U', 791},
                                                   {'R', 205},
                                                   {'U', 352},
                                                   {'L', 510},
                                                   {'D', 975},
                                                   {'R', 47},
                                                   {'D', 311},
                                                   {'R', 319},
                                                   {'U', 579},
                                                   {'R', 214},
                                                   {'D', 112},
                                                   {'R', 996},
                                                   {'U', 874},
                                                   {'R', 328},
                                                   {'D', 578},
                                                   {'R', 37},
                                                   {'U', 689},
                                                   {'L', 543},
                                                   {'U', 16},
                                                   {'L', 580},
                                                   {'D', 230},
                                                   {'L', 714},
                                                   {'D', 58},
                                                   {'L', 580},
                                                   {'D', 658},
                                                   {'R', 218},
                                                   {'U', 535},
                                                   {'R', 149},
                                                   {'U', 996},
                                                   {'L', 173},
                                                   {'D', 316},
                                                   {'L', 90},
                                                   {'D', 372},
                                                   {'L', 364},
                                                   {'U', 700},
                                                   {'L', 60},
                                                   {'D', 70},
                                                   {'L', 250},
                                                   {'U', 276},
                                                   {'R', 580},
                                                   {'U', 505},
                                                   {'L', 682},
                                                   {'U', 943},
                                                   {'R', 336},
                                                   {'U', 847},
                                                   {'R', 810},
                                                   {'U', 963},
                                                   {'R', 874},
                                                   {'D', 740},
                                                   {'R', 732},
                                                   {'D', 328},
                                                   {'R', 926},
                                                   {'D', 447},
                                                   {'R', 638},
                                                   {'D', 102},
                                                   {'R', 696},
                                                   {'U', 211},
                                                   {'L', 594},
                                                   {'D', 354},
                                                   {'R', 384},
                                                   {'U', 81},
                                                   {'L', 884},
                                                   {'U', 916},
                                                   {'L', 168},
                                                   {'U', 759},
                                                   {'R', 631},
                                                   {'D', 702},
                                                   {'L', 598},
                                                   {'D', 382},
                                                   {'L', 647},
                                                   {'U', 642},
                                                   {'R', 537},
                                                   {'U', 53},
                                                   {'R', 897},
                                                   {'U', 954},
                                                   {'R', 263},
                                                   {'U', 445},
                                                   {'L', 41},
                                                   {'D', 91},
                                                   {'L', 51},
                                                   {'D', 338},
                                                   {'R', 219},
                                                   {'U', 269},
                                                   {'L', 689},
                                                   {'D', 172},
                                                   {'R', 627},
                                                   {'D', 287},
                                                   {'L', 440},
                                                   {'D', 504},
                                                   {'L', 253},
                                                   {'D', 252},
                                                   {'R', 815},
                                                   {'D', 108},
                                                   {'L', 282},
                                                   {'U', 835},
                                                   {'L', 243},
                                                   {'U', 638},
                                                   {'R', 910},
                                                   {'D', 306},
                                                   {'R', 755},
                                                   {'D', 202},
                                                   {'R', 69},
                                                   {'D', 862},
                                                   {'L', 537},
                                                   {'D', 947},
                                                   {'L', 180},
                                                   {'D', 835},
                                                   {'L', 111},
                                                   {'U', 832},
                                                   {'R', 939},
                                                   {'D', 449},
                                                   {'R', 180},
                                                   {'U', 105},
                                                   {'R', 892},
                                                   {'D', 837},
                                                   {'L', 153},
                                                   {'U', 215},
                                                   {'L', 695},
                                                   {'U', 957},
                                                   {'R', 923},
                                                   {'U', 496},
                                                   {'R', 608},
                                                   {'U', 739},
                                                   {'L', 711},
                                                   {'U', 700},
                                                   {'L', 838},
                                                   {'D', 117},
                                                   {'R', 479},
                                                   {'U', 852},
                                                   {'R', 795},
                                                   {'D', 955},
                                                   {'L', 386},
                                                   {'D', 70},
                                                   {'R', 728},
                                                   {'D', 40},
                                                   {'R', 580},
                                                   {'U', 777},
                                                   {'L', 877},
                                                   {'U', 284},
                                                   {'R', 414},
                                                   {'D', 300},
                                                   {'R', 105},
                                                   {'D', 372},
                                                   {'L', 317},
                                                   {'D', 91},
                                                   {'R', 653},
                                                   {'U', 920},
                                                   {'R', 956},
                                                   {'D', 496},
                                                   {'L', 543},
                                                   {'D', 363},
                                                   {'R', 374},
                                                   {'D', 283},
                                                   {'L', 696},
                                                   {'U', 466},
                                                   {'R', 467},
                                                   {'D', 878},
                                                   {'R', 660},
                                                   {'U', 590},
                                                   {'L', 962},
                                                   {'U', 619},
                                                   {'R', 991},
                                                   {'U', 848},
                                                   {'L', 648},
                                                   {'D', 191},
                                                   {'R', 459},
                                                   {'U', 125},
                                                   {'L', 998},
                                                   {'U', 19},
                                                   {'L', 214},
                                                   {'U', 947},
                                                   {'R', 188},
                                                   {'U', 103},
                                                   {'R', 916}};
static std::vector<std::tuple<char, int>> second = {{'L', 1008},
                                                    {'U', 717},
                                                    {'R', 288},
                                                    {'D', 770},
                                                    {'R', 270},
                                                    {'U', 514},
                                                    {'R', 109},
                                                    {'D', 538},
                                                    {'L', 719},
                                                    {'U', 179},
                                                    {'R', 466},
                                                    {'D', 792},
                                                    {'R', 421},
                                                    {'U', 723},
                                                    {'L', 22},
                                                    {'U', 705},
                                                    {'L', 284},
                                                    {'U', 14},
                                                    {'L', 478},
                                                    {'U', 367},
                                                    {'R', 727},
                                                    {'U', 880},
                                                    {'R', 620},
                                                    {'D', 46},
                                                    {'R', 377},
                                                    {'U', 897},
                                                    {'L', 731},
                                                    {'U', 840},
                                                    {'L', 910},
                                                    {'D', 385},
                                                    {'L', 257},
                                                    {'U', 311},
                                                    {'L', 596},
                                                    {'D', 991},
                                                    {'L', 668},
                                                    {'D', 730},
                                                    {'L', 707},
                                                    {'D', 816},
                                                    {'R', 47},
                                                    {'U', 948},
                                                    {'R', 84},
                                                    {'D', 700},
                                                    {'R', 299},
                                                    {'U', 707},
                                                    {'R', 261},
                                                    {'D', 928},
                                                    {'R', 358},
                                                    {'D', 504},
                                                    {'R', 309},
                                                    {'U', 369},
                                                    {'R', 931},
                                                    {'U', 20},
                                                    {'L', 940},
                                                    {'U', 326},
                                                    {'L', 362},
                                                    {'D', 52},
                                                    {'R', 98},
                                                    {'D', 475},
                                                    {'L', 907},
                                                    {'D', 918},
                                                    {'R', 931},
                                                    {'D', 468},
                                                    {'R', 279},
                                                    {'D', 586},
                                                    {'R', 592},
                                                    {'U', 973},
                                                    {'R', 753},
                                                    {'D', 365},
                                                    {'R', 694},
                                                    {'U', 278},
                                                    {'R', 934},
                                                    {'U', 712},
                                                    {'R', 441},
                                                    {'U', 996},
                                                    {'L', 989},
                                                    {'D', 693},
                                                    {'L', 211},
                                                    {'D', 561},
                                                    {'R', 105},
                                                    {'D', 425},
                                                    {'R', 53},
                                                    {'U', 168},
                                                    {'L', 451},
                                                    {'U', 865},
                                                    {'L', 585},
                                                    {'D', 412},
                                                    {'L', 857},
                                                    {'U', 988},
                                                    {'R', 724},
                                                    {'U', 774},
                                                    {'R', 295},
                                                    {'U', 588},
                                                    {'R', 329},
                                                    {'D', 810},
                                                    {'L', 698},
                                                    {'D', 118},
                                                    {'R', 277},
                                                    {'U', 193},
                                                    {'R', 309},
                                                    {'U', 933},
                                                    {'R', 186},
                                                    {'D', 535},
                                                    {'R', 409},
                                                    {'U', 322},
                                                    {'L', 849},
                                                    {'U', 606},
                                                    {'R', 590},
                                                    {'U', 892},
                                                    {'L', 542},
                                                    {'D', 237},
                                                    {'R', 475},
                                                    {'D', 920},
                                                    {'R', 679},
                                                    {'U', 602},
                                                    {'L', 477},
                                                    {'D', 634},
                                                    {'L', 988},
                                                    {'D', 540},
                                                    {'L', 323},
                                                    {'U', 791},
                                                    {'L', 375},
                                                    {'U', 625},
                                                    {'L', 621},
                                                    {'U', 567},
                                                    {'L', 943},
                                                    {'U', 512},
                                                    {'L', 239},
                                                    {'D', 90},
                                                    {'L', 66},
                                                    {'U', 151},
                                                    {'R', 83},
                                                    {'U', 435},
                                                    {'R', 612},
                                                    {'D', 865},
                                                    {'L', 177},
                                                    {'U', 368},
                                                    {'R', 326},
                                                    {'U', 574},
                                                    {'L', 241},
                                                    {'U', 197},
                                                    {'R', 499},
                                                    {'U', 419},
                                                    {'R', 297},
                                                    {'U', 207},
                                                    {'L', 311},
                                                    {'D', 243},
                                                    {'L', 559},
                                                    {'D', 281},
                                                    {'R', 513},
                                                    {'U', 748},
                                                    {'L', 884},
                                                    {'U', 207},
                                                    {'R', 71},
                                                    {'D', 441},
                                                    {'R', 133},
                                                    {'D', 993},
                                                    {'L', 4},
                                                    {'D', 977},
                                                    {'L', 669},
                                                    {'U', 523},
                                                    {'L', 564},
                                                    {'U', 186},
                                                    {'R', 477},
                                                    {'U', 737},
                                                    {'L', 685},
                                                    {'U', 338},
                                                    {'L', 456},
                                                    {'U', 939},
                                                    {'R', 774},
                                                    {'U', 674},
                                                    {'L', 97},
                                                    {'D', 827},
                                                    {'R', 237},
                                                    {'D', 451},
                                                    {'R', 618},
                                                    {'D', 143},
                                                    {'R', 750},
                                                    {'U', 196},
                                                    {'L', 559},
                                                    {'D', 178},
                                                    {'L', 693},
                                                    {'D', 916},
                                                    {'R', 334},
                                                    {'U', 231},
                                                    {'L', 651},
                                                    {'U', 249},
                                                    {'R', 620},
                                                    {'U', 283},
                                                    {'L', 387},
                                                    {'U', 352},
                                                    {'L', 915},
                                                    {'U', 959},
                                                    {'L', 693},
                                                    {'U', 909},
                                                    {'R', 320},
                                                    {'U', 119},
                                                    {'L', 617},
                                                    {'U', 177},
                                                    {'L', 993},
                                                    {'D', 265},
                                                    {'R', 667},
                                                    {'U', 204},
                                                    {'R', 59},
                                                    {'D', 601},
                                                    {'L', 579},
                                                    {'U', 483},
                                                    {'R', 155},
                                                    {'D', 484},
                                                    {'L', 44},
                                                    {'D', 751},
                                                    {'R', 915},
                                                    {'U', 510},
                                                    {'L', 552},
                                                    {'U', 308},
                                                    {'R', 505},
                                                    {'U', 394},
                                                    {'R', 585},
                                                    {'U', 872},
                                                    {'L', 617},
                                                    {'U', 202},
                                                    {'R', 928},
                                                    {'U', 941},
                                                    {'R', 235},
                                                    {'U', 768},
                                                    {'R', 666},
                                                    {'D', 547},
                                                    {'L', 244},
                                                    {'D', 270},
                                                    {'R', 353},
                                                    {'D', 612},
                                                    {'R', 384},
                                                    {'U', 430},
                                                    {'L', 685},
                                                    {'D', 536},
                                                    {'R', 103},
                                                    {'U', 147},
                                                    {'R', 794},
                                                    {'D', 621},
                                                    {'L', 52},
                                                    {'U', 96},
                                                    {'L', 557},
                                                    {'D', 455},
                                                    {'L', 635},
                                                    {'D', 58},
                                                    {'R', 265},
                                                    {'U', 545},
                                                    {'R', 938},
                                                    {'D', 266},
                                                    {'L', 173},
                                                    {'U', 746},
                                                    {'L', 672},
                                                    {'D', 237},
                                                    {'R', 286},
                                                    {'U', 131},
                                                    {'R', 487},
                                                    {'U', 837},
                                                    {'R', 394},
                                                    {'D', 702},
                                                    {'R', 49},
                                                    {'U', 579},
                                                    {'L', 699},
                                                    {'U', 819},
                                                    {'L', 448},
                                                    {'D', 223},
                                                    {'L', 982},
                                                    {'D', 906},
                                                    {'L', 397},
                                                    {'U', 807},
                                                    {'L', 737},
                                                    {'D', 223},
                                                    {'L', 791},
                                                    {'D', 965},
                                                    {'R', 436},
                                                    {'U', 29},
                                                    {'R', 908},
                                                    {'D', 273},
                                                    {'R', 194},
                                                    {'U', 91},
                                                    {'R', 232},
                                                    {'U', 591},
                                                    {'L', 336},
                                                    {'D', 70},
                                                    {'R', 467},
                                                    {'U', 505},
                                                    {'L', 341},
                                                    {'U', 989},
                                                    {'R', 278},
                                                    {'U', 387},
                                                    {'L', 442},
                                                    {'U', 950},
                                                    {'R', 487},
                                                    {'D', 384},
                                                    {'L', 534},
                                                    {'D', 514},
                                                    {'L', 433},
                                                    {'U', 627},
                                                    {'R', 381},
                                                    {'U', 54},
                                                    {'L', 847},
                                                    {'U', 231},
                                                    {'L', 590}};

static std::tuple<std::set<std::tuple<int, int>>,
        std::map<std::tuple<int, int>, int> > trace(const std::vector<std::tuple<char, int>> &path) {
    std::set<std::tuple<int, int>> t;
    std::map<std::tuple<int, int>, int> m;

    int x = 0, y = 0;
    int s = 0;
    for (auto [direction, length]: path) {
        switch (direction) {
            case 'L':
                for (int i = 0; i < length; i++) {
                    t.insert({--x, y});
                    m.insert({{x, y}, ++s});
                }
                break;
            case 'R':
                for (int i = 0; i < length; i++) {
                    t.insert({++x, y});
                    m.insert({{x, y}, ++s});
                }
                break;
            case 'U':
                for (int i = 0; i < length; i++) {
                    t.insert({x, --y});
                    m.insert({{x, y}, ++s});
                }
                break;
            case 'D':
                for (int i = 0; i < length; i++) {
                    t.insert({x, ++y});
                    m.insert({{x, y}, ++s});
                }
                break;
            default:
                assert(false);
        }
    }
    return {t, m};
}


template<typename T>
static void print(const T &container) {
    for (auto &[x, y]: container) {
        std::cout << "(" << x << ", " << y << "), ";
    }
    std::cout << std::endl;
}

int _3() {
    auto [first_trace, first_map] = trace(first);
    auto [second_trace, second_map] = trace(second);

    print(first_trace);
    print(second_trace);

    std::vector<std::tuple<int, int>> v_intersection;
    std::set_intersection(first_trace.begin(), first_trace.end(),
                          second_trace.begin(), second_trace.end(),
                          std::back_inserter(v_intersection));

    print(v_intersection);

    int min_distance = std::numeric_limits<int>::max();
    int min_steps = std::numeric_limits<int>::max();
    for (auto [x, y]: v_intersection) {
        int distance = abs(x) + abs(y);
        min_distance = std::min(min_distance, distance);

        int steps = first_map[{x, y}] + second_map[{x, y}];
        min_steps = std::min(min_steps, steps);
        std::cout << distance << std::endl;
    }
    std::cout << min_distance << std::endl;
    std::cout << min_steps << std::endl;

    return 0;
}
